<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>GeNN: Tutorial 2</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<!--This is Google Analytics Tracking Code-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-57354659-1', 'auto');
  ga('send', 'pageview');
</script>
<!--End of Google Analytics Tracking Code-->
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../customdoxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em; padding-bottom: 0.5em;" id="projectlogo"><img alt="Logo" src="../../GeNN-logo-55px.gif"/></td>
  <td style="padding-left: 3.5em; padding-bottom: 0.5em;">
   <div id="projectname">GeNN
   &#160;<span id="projectnumber">2.0</span>
   </div>
   <div id="projectbrief">GPU enhanced Neuronal Networks (GeNN)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('dc/d7e/Tutorial2.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Tutorial 2 </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>In this tutorial we will learn to add synapsePopulations to connect neurons in neuron groups to each other with synatic models. We will as an example connect the ten Hodgkin-Huxley neurons from tutorial 1 in a ring of excitatory synapses.</p>
<p>First, copy the files from Tutorial 1 into a new directory and rename them to new names, e.g. </p><div class="fragment"><div class="line">&gt;&gt; cp -r tenHH_project tenHHRing_project</div>
<div class="line">&gt;&gt; cd tenHHRing_project</div>
<div class="line">&gt;&gt; mv tenHHModel.cc tenHHRingModel.cc</div>
<div class="line">&gt;&gt; mv tenHHSimulation.cu tenHHRingSimulation.cu</div>
</div><!-- fragment --><p> Now, we need to add a synapse group to the model that allows to connect neurons from the Pop1 group to connect to other neurons of this group. Open <code>tenHHRingModel.cc</code>, change the model name inside, </p><div class="fragment"><div class="line">model.<a class="code" href="../../dc/de5/classNNmodel.html#a757eff2a5877688e6e5492726df035ee">setName</a>(<span class="stringliteral">&quot;tenHHRing&quot;</span>);</div>
</div><!-- fragment --><h1><a class="anchor" id="addSynapse"></a>
Adding Synaptic connections</h1>
<p>Now we need additional initial values and parameters for the synapse and post-synaptic models. We will use the standard <code>NSYNAPSE</code> weightu[adte model and <code>EXPDECAY</code> post-synaptic model. They need intial variables and parameters as follows: </p><div class="fragment"><div class="line"><span class="keywordtype">double</span> s_ini[1] = {</div>
<div class="line">  0.0      <span class="comment">// 0 - g: the synaptic conductance value</span></div>
<div class="line">};</div>
<div class="line"><span class="keywordtype">double</span> *s_p= NULL;</div>
<div class="line"><span class="keywordtype">double</span> *ps_ini= NULL;</div>
<div class="line"><span class="keywordtype">double</span> ps_p[2]= {</div>
<div class="line">  1.0,      <span class="comment">// 0 - tau_S: decay time constant for S [ms]</span></div>
<div class="line">  -80.0     <span class="comment">// 1 - Erev: Reversal potential</span></div>
<div class="line">};</div>
</div><!-- fragment --><p> If an array is not needed we pass in a NULL pointer. Here there are for example no synaptic parameters and no initial values for the post-synaptic mechanism. We can then add a synapse population at the end of the <code>modelDefinition(...)</code> function, </p><div class="fragment"><div class="line">model.<a class="code" href="../../dc/de5/classNNmodel.html#ae252945f336a330ec1c69f24cb1d4203">addSynapsePopulation</a>(<span class="stringliteral">&quot;Pop1self&quot;</span>, <a class="code" href="../../dc/de1/modelSpec_8h.html#a1110b98e1962bdb6bcc86b647b1431d4">NSYNAPSE</a>, <a class="code" href="../../dc/de1/modelSpec_8h.html#ad6b1ce8b615d4247eedb05c21f03ef71">DENSE</a>, <a class="code" href="../../dc/de1/modelSpec_8h.html#a816cbd49fb536367065e2306f5495444">INDIVIDUALG</a>, <a class="code" href="../../dc/de1/modelSpec_8h.html#a291aa33d0e485ee09a6881cf8056e13c">NO_DELAY</a>, <a class="code" href="../../dc/de1/modelSpec_8h.html#a49eb71ad1b005eccc948e788d0ae524b">EXPDECAY</a>, <span class="stringliteral">&quot;Pop1&quot;</span>, <span class="stringliteral">&quot;Pop1&quot;</span>, s_ini, s_p, ps_ini, ps_p);</div>
</div><!-- fragment --><p> The addSynapsePopulation parameters are </p><ul>
<li><code>const char *name</code>: The name of the synapse population, here "Pop1self" </li>
<li><code>int sType</code>: The type of synapse to be added, we here use the predefined typse <code>NSYNAPSE</code>. See <a class="el" href="../../d5/d24/sectSynapseModels.html#subsect31">Built-in Models</a> for all available predefined synapse types. </li>
<li><code>int sConn</code>: The type of synaptic connectivity, here <code>DENSE</code> which means we will provide a full connectivity mtrix later. </li>
<li><code>int</code> <code>gType:</code> The way how the synaptic conductivity g will be defined. With <code>GLOBALG</code> we indicate that all conductance are of the same conductance value, which will be the value given in <code>sPara</code>. </li>
<li><code>int delay</code>: <code>NO_DELAY</code> means that there wil be no delays for synaptic signal propagation. </li>
<li><code>int postSyn</code>: Postsynaptic integration method, we are here using the standard model of an exponential decay of synaptic excitation. </li>
<li><code>char *preName</code>: Name of the pre-synaptic neuron population, here the <code>Pop1</code> population. </li>
<li><code>char *postName</code>: Name of the post-synaptic neuron population, here also <code>Pop1</code>. </li>
<li><code>double *sIni</code>: A C-array of doubles containing initial values for the synaptic variables. </li>
<li><code>double *sParam</code>: A C-array of double precision that contains parameter values (common to all synapses of the population) </li>
<li><code>double *psIni</code>: A C-array of double precision numbers containing initial values for the post-synaptic model variables </li>
<li><code>double *psPara</code>: A C-array of double precision numbers containing parameters fo the post-snaptic model.</li>
</ul>
<p>Adding the addSynapsePopulation command to the model definition informs GeNN that there will be synapses between the named neuron populations, here between population <code>Pop1</code> and itself. The detailed conenctivity as defined by the variables <code>g</code>, we have still to define in the setup of our simulation. At this point our model definition file <code>tenHHRingModel.cc</code> should look like this </p><div class="fragment"><div class="line"><span class="comment">// Model definintion file tenHHModel.cc</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#define DT 0.1 </span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../dc/de1/modelSpec_8h.html">modelSpec.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../d7/dfd/modelSpec_8cc.html">modelSpec.cc</a>&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="../../d9/dba/HHVClamp_8cc.html#a9aeaa0a22980484b2c472564fc9f686e">modelDefinition</a>(<a class="code" href="../../dc/de5/classNNmodel.html">NNmodel</a> &amp;model)</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// definition of tenHHModel</span></div>
<div class="line">  <a class="code" href="../../d7/dfd/modelSpec_8cc.html#a62ce532f6f7e535adfb9fe151a1c0c6b">initGeNN</a>();</div>
<div class="line">  model.<a class="code" href="../../dc/de5/classNNmodel.html#a757eff2a5877688e6e5492726df035ee">setName</a>(<span class="stringliteral">&quot;tenHHRingModel&quot;</span>);</div>
<div class="line">  <span class="keywordtype">double</span> p[7]= {</div>
<div class="line">    7.15,          <span class="comment">// 0 - gNa: Na conductance in muS</span></div>
<div class="line">    50.0,          <span class="comment">// 1 - ENa: Na equi potential in mV</span></div>
<div class="line">    1.43,          <span class="comment">// 2 - gK: K conductance in muS</span></div>
<div class="line">   -95.0,          <span class="comment">// 3 - EK: K equi potential in mV </span></div>
<div class="line">    0.02672,       <span class="comment">// 4 - gl: leak conductance in muS</span></div>
<div class="line">    -63.563,       <span class="comment">// 5 - El: leak equi potential in mV</span></div>
<div class="line">    0.143          <span class="comment">// 6 - Cmem: membr. capacity density in nF</span></div>
<div class="line">  }; </div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">double</span> ini[4]= {</div>
<div class="line">    -60.0,         <span class="comment">// 0 - membrane potential V</span></div>
<div class="line">    0.0529324,     <span class="comment">// 1 - prob. for Na channel activation m</span></div>
<div class="line">    0.3176767,     <span class="comment">// 2 - prob. for not Na channel blocking h</span></div>
<div class="line">    0.5961207      <span class="comment">// 3 - prob. for K channel activation n</span></div>
<div class="line">  };</div>
<div class="line">  model.<a class="code" href="../../dc/de5/classNNmodel.html#a32c254358da2f8c43c91291d24cfd295">addNeuronPopulation</a>(<span class="stringliteral">&quot;Pop1&quot;</span>, 10, <a class="code" href="../../dc/de1/modelSpec_8h.html#a5cb672a4c033703aeb1b7ba7350cfbfd">TRAUBMILES</a>, p, ini);</div>
<div class="line">  model.<a class="code" href="../../dc/de5/classNNmodel.html#a95724e1798bd9ac5642a8fb2484a2f93">activateDirectInput</a>(<span class="stringliteral">&quot;Pop1&quot;</span>, <a class="code" href="../../dc/de1/modelSpec_8h.html#a921b56858504259e999652795a93f6be">CONSTINP</a>);</div>
<div class="line">  model.<a class="code" href="../../dc/de5/classNNmodel.html#a25ab2e7846813491aff8276a8a1b00b1">setConstInp</a>(<span class="stringliteral">&quot;Pop1&quot;</span>, 0.1);</div>
<div class="line">  <span class="keywordtype">double</span> s_ini[1] = {</div>
<div class="line">    0.0       <span class="comment">// 0 - g: the synaptic conductance value</span></div>
<div class="line">  };</div>
<div class="line">  <span class="keywordtype">double</span> *s_p= NULL;</div>
<div class="line">  <span class="keywordtype">double</span> *ps_ini= NULL;</div>
<div class="line">  <span class="keywordtype">double</span> ps_p[2]= {</div>
<div class="line">    1.0,      <span class="comment">// 0 - tau_S: decay time constant for S [ms]</span></div>
<div class="line">    -80.0     <span class="comment">// 1 - Erev: Reversal potential</span></div>
<div class="line">  };</div>
<div class="line">  model.<a class="code" href="../../dc/de5/classNNmodel.html#ae252945f336a330ec1c69f24cb1d4203">addSynapsePopulation</a>(<span class="stringliteral">&quot;Pop1self&quot;</span>, <a class="code" href="../../dc/de1/modelSpec_8h.html#a1110b98e1962bdb6bcc86b647b1431d4">NSYNAPSE</a>, <a class="code" href="../../dc/de1/modelSpec_8h.html#ad6b1ce8b615d4247eedb05c21f03ef71">DENSE</a>, <a class="code" href="../../dc/de1/modelSpec_8h.html#a816cbd49fb536367065e2306f5495444">INDIVIDUALG</a>, <a class="code" href="../../dc/de1/modelSpec_8h.html#a291aa33d0e485ee09a6881cf8056e13c">NO_DELAY</a>, <a class="code" href="../../dc/de1/modelSpec_8h.html#a49eb71ad1b005eccc948e788d0ae524b">EXPDECAY</a>, <span class="stringliteral">&quot;Pop1&quot;</span>, <span class="stringliteral">&quot;Pop1&quot;</span>, s_ini, s_p, ps_ini, ps_p);</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="SynapseMatrix"></a>
Defining the Detailed Synaptic Connections</h1>
<p>Open the <code>tenHHRingSimulation.cu</code> file and update the file names of includes: </p><div class="fragment"><div class="line"><span class="comment">// tenHHRingModel simulation code</span></div>
<div class="line"><span class="preprocessor">#include &quot;tenHHRingModel.cc&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;tenHHRingModel_CODE/runner.cc&quot;</span></div>
</div><!-- fragment --><p> Now we need to add code to generate the desired ring connectivity. </p><div class="fragment"><div class="line">allocateMem();</div>
<div class="line">initialize();</div>
<div class="line"><span class="comment">// define the connectivity</span></div>
<div class="line"><span class="keywordtype">int</span> pre, post;</div>
<div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">int</span> i= 0; i &lt; 10; i++) {</div>
<div class="line">  pre= i;</div>
<div class="line">  post= (i+1)%10;</div>
<div class="line">  gPop1self[pre*10+post]= 0.01;</div>
<div class="line">}</div>
<div class="line">pushPop1selftoDevice();</div>
</div><!-- fragment --><p> After memory allocation and initialization <code>gPop1self</code> will contain only zeros. We then assign in the loop a non-zero conductivity of 0.01 <img class="formulaInl" alt="$\mu$" src="../../form_10.png"/>S to all synapses from neuron <code>i</code> to <code>i+1</code> (and <code>9</code> to <code>8</code> to close the ring).</p>
<p>After adjusting the GNUmakefile to read </p><div class="fragment"><div class="line">EXECUTABLE      :=tenHHRingSimulation</div>
<div class="line">SOURCES         :=tenHHRingSimulation.cu</div>
<div class="line"></div>
<div class="line">include $(GENN_PATH)/userproject/include/makefile_common_gnu.mk</div>
</div><!-- fragment --><p> we can build the model </p><div class="fragment"><div class="line">&gt;&gt; buildmodel.sh tenHHRingModel</div>
</div><!-- fragment --><p> and make it </p><div class="fragment"><div class="line">&gt;&gt; make clean all</div>
</div><!-- fragment --><p> After this there should be an exectable <code>tenHHRingSimulation</code>, which can be executed, </p><div class="fragment"><div class="line">&gt;&gt; ./tenHHRingSimulation</div>
</div><!-- fragment --><p> which should again result in </p><div class="fragment"><div class="line">-64.9054 0.0147837 0.981337 0.030886</div>
<div class="line">-64.9054 0.0147837 0.981337 0.030886</div>
<div class="line">-64.9054 0.0147837 0.981337 0.030886</div>
<div class="line">-64.9054 0.0147837 0.981337 0.030886</div>
<div class="line">-64.9054 0.0147837 0.981337 0.030886</div>
<div class="line">-64.9054 0.0147837 0.981337 0.030886</div>
<div class="line">-64.9054 0.0147837 0.981337 0.030886</div>
<div class="line">-64.9054 0.0147837 0.981337 0.030886</div>
<div class="line">-64.9054 0.0147837 0.981337 0.030886</div>
<div class="line">-64.9054 0.0147837 0.981337 0.030886</div>
</div><!-- fragment --><p> If we plot the content of columns one and two of <code>tenHHexample.V.dat</code> it looks very similar as in <a class="el" href="../../d5/dbb/Tutorial1.html">Tutorial 1</a> </p><div class="image">
<img src="../../tenHHRingexample1.png" alt="tenHHRingexample1.png"/>
</div>
 <p>This is because the inhibitory synapses we created were all triggered at the same time so that they act during a post-synaptic spike which makes their effect all but invisible.</p>
<h1><a class="anchor" id="initialConditions"></a>
Setting Heterogeneous Initial Conditions</h1>
<p>If we define different initial conditions for each of the ten neurons, add after <code>initialize()</code>, </p><div class="fragment"><div class="line"><span class="comment">// set initial variables</span></div>
<div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">int</span> i= 0; i &lt; 10; i++) {</div>
<div class="line">  VPop1[i]= -60.0+i;</div>
<div class="line">}</div>
<div class="line">pushPop1toDevice();   </div>
</div><!-- fragment --><p> then we observe different final values for each neuron, </p><div class="fragment"><div class="line">-57.3412 0.06223 0.981374 0.104417</div>
<div class="line">-53.3189 0.442962 0.0664687 0.764513</div>
<div class="line">-73.1413 0.00253709 0.927251 0.0277236</div>
<div class="line">-67.1179 0.00927304 0.986692 0.0206106</div>
<div class="line">-63.5878 0.01938 0.991071 0.0387962</div>
<div class="line">-62.2114 0.0255295 0.990933 0.0504799</div>
<div class="line">-61.404 0.0298902 0.990949 0.0586459</div>
<div class="line">-60.6691 0.034405 0.990225 0.0668015</div>
<div class="line">-59.8977 0.0397467 0.988701 0.0758159</div>
<div class="line">-58.9727 0.0470178 0.98615 0.0866963</div>
</div><!-- fragment --><p> and zooming in on the first 200 ms, the voltage of the first neuron now looks like this </p><div class="image">
<img src="../../tenHHRingexample2.png" alt="tenHHRingexample2.png"/>
</div>
 <p>The complete codes for this tutorial are in <code>userproject\tenHHRing_project</code>. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Dec 22 2014 23:15:37 for GeNN by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.7 </li>
  </ul>
</div>
</body>
</html>
