<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>GeNN: Variable initialisation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<!--This is Google Analytics Tracking Code-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-57354659-1', 'auto');
  ga('send', 'pageview');
</script>
<!--End of Google Analytics Tracking Code-->
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="customdoxygen.css" rel="stylesheet" type="text/css" />
<link href="html_styles.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em; padding-bottom: 0.5em;" id="projectlogo"><img alt="Logo" src="GeNN-logo-55px.gif"/></td>
  <td style="padding-left: 3.5em; padding-bottom: 0.5em;">
   <div id="projectname">GeNN
   &#160;<span id="projectnumber">3.1.1</span>
   </div>
   <div id="projectbrief">GPU enhanced Neuronal Networks (GeNN)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('sectVariableInitialisation.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Variable initialisation </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Neuron, weight update and postsynaptic models all have state variables which GeNN can automatically initialise. </p><dl class="section note"><dt>Note</dt><dd>In previous versions of GeNN, weight update models state variables for synapse populations with sparse connectivity were not automatically initialised. This behaviour remains the default, but by setting <div class="fragment"><div class="line"><a class="code" href="d8/d27/namespaceGENN__PREFERENCES.html#a708fe713881a49526d8787d9fc00a2b6">GENN_PREFERENCES::autoInitSparseVars</a>=<span class="keyword">true</span>;</div></div><!-- fragment --> this can be overriden.</dd></dl>
<p>Previously we have shown variables being initialised to constant values such as: </p><div class="fragment"><div class="line"><a class="code" href="d6/d53/classNewModels_1_1VarInitContainerBase.html">NeuronModels::TraubMiles::VarValues</a> ini(</div><div class="line">    0.0529324,     <span class="comment">// 1 - prob. for Na channel activation m</span></div><div class="line">    ...</div><div class="line">);</div></div><!-- fragment --><p> state variables can also be left <em>uninitialised</em> leaving it up to the user code to initialise them: </p><div class="fragment"><div class="line"><a class="code" href="d6/d53/classNewModels_1_1VarInitContainerBase.html">NeuronModels::TraubMiles::VarValues</a> ini(</div><div class="line">    <a class="code" href="dc/de1/modelSpec_8h.html#a4916e3559295d02263b13092e3d4e2e1">uninitialisedVar</a>(),     <span class="comment">// 1 - prob. for Na channel activation m</span></div><div class="line">    ...</div><div class="line">);</div></div><!-- fragment --><p> or initialised using one of a number of predefined <em>variable initialisation snippets</em>:</p><ul>
<li><a class="el" href="dd/da0/classInitVarSnippet_1_1Uniform.html" title="Initialises variable by sampling from the uniform distribution. ">InitVarSnippet::Uniform</a></li>
<li><a class="el" href="d5/dc1/classInitVarSnippet_1_1Normal.html" title="Initialises variable by sampling from the normal distribution. ">InitVarSnippet::Normal</a></li>
<li><a class="el" href="d8/d70/classInitVarSnippet_1_1Exponential.html" title="Initialises variable by sampling from the exponential distribution. ">InitVarSnippet::Exponential</a></li>
</ul>
<p>For example, to initialise a parameter using values drawn from the normal distribution: </p><div class="fragment"><div class="line">InitVarSnippet::Normal::ParamValues params(</div><div class="line">    0.05,   <span class="comment">// 0 - mean</span></div><div class="line">    0.01);  <span class="comment">// 1 - standard deviation</span></div><div class="line">    </div><div class="line"><a class="code" href="d6/d53/classNewModels_1_1VarInitContainerBase.html">NeuronModels::TraubMiles::VarValues</a> ini(</div><div class="line">    initVar&lt;InitVarSnippet::Normal&gt;(params),     <span class="comment">// 1 - prob. for Na channel activation m</span></div><div class="line">    ...</div><div class="line">);</div></div><!-- fragment --> <h1><a class="anchor" id="sect_new_var_init"></a>
Defining a new variable initialisation snippet</h1>
<p>Similarly to neuron, weight update and postsynaptic models, new variable initialisation snippets can be created by simply defining a class in the model description. For example, when initialising excitatory (positive) synaptic weights with a normal distribution they should be clipped at 0 so the long tail of the normal distribution doesn't result in negative weights. This could be implemented using the following variable initialisation snippet which redraws until samples are within the desired bounds: </p><div class="fragment"><div class="line"><span class="keyword">class </span>NormalPositive : <span class="keyword">public</span> <a class="code" href="d3/d9e/classInitVarSnippet_1_1Base.html">InitVarSnippet::Base</a></div><div class="line">{</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <a class="code" href="de/d6c/snippet_8h.html#ac5727a6720d28f034afadde948ed6e9a">DECLARE_SNIPPET</a>(NormalPositive, 2);</div><div class="line"></div><div class="line">    <a class="code" href="d9/ddf/initVarSnippet_8h.html#a4b6549c5c6a7a5b8058283d68fa11578">SET_CODE</a>(</div><div class="line">        <span class="stringliteral">&quot;scalar normal;&quot;</span></div><div class="line">        <span class="stringliteral">&quot;do\n&quot;</span></div><div class="line">        <span class="stringliteral">&quot;{\n&quot;</span></div><div class="line">        <span class="stringliteral">&quot;   normal = $(mean) + ($(gennrand_normal) * $(sd));\n&quot;</span></div><div class="line">        <span class="stringliteral">&quot;} while (normal &lt; 0.0);\n&quot;</span></div><div class="line">        <span class="stringliteral">&quot;$(value) = normal;\n&quot;</span>);</div><div class="line"></div><div class="line">    <a class="code" href="de/d6c/snippet_8h.html#a75315265035fd71c5b5f7d7f449edbd7">SET_PARAM_NAMES</a>({<span class="stringliteral">&quot;mean&quot;</span>, <span class="stringliteral">&quot;sd&quot;</span>});</div><div class="line">};</div><div class="line"><a class="code" href="de/d6c/snippet_8h.html#af3c47debe5fc34060e716d7db25462ab">IMPLEMENT_SNIPPET</a>(NormalPositive);</div></div><!-- fragment --><h1><a class="anchor" id="sect_var_init_modes"></a>
Variable initialisation modes</h1>
<p>Once you have defined <b>how</b> your variables are going to be initialised you need to configure <b>where</b> they will be initialised and allocated. By default memory is allocated for variables on both the GPU and the host; and variables are initialised on the host as described in section <a class="el" href="sectVariableInitialisation.html">Variable initialisation</a> and then uploaded to the GPU. However, variable initialisation can also be offloaded to the GPU, potentially reducing the time spent both calculating the initial values and uploading them. To enable this functionality the following alternative modes of operation are available:</p><ul>
<li><a class="el" href="d6/d8f/variableMode_8h.html#a21a79f2184074500f38877a503a4716dabd76a9421f4f245836afe88d46ee7c8c">VarMode::LOC_DEVICE_INIT_DEVICE</a> - Variables are only allocated on the GPU (and thus initialised there), saving memory but meaning that they can't easily be copied to the host - best for internal state variables.</li>
<li><a class="el" href="d6/d8f/variableMode_8h.html#a21a79f2184074500f38877a503a4716da261805b94ce3201a8d520e6e516eb960">VarMode::LOC_HOST_DEVICE_INIT_HOST</a> - Variables are allocated on both the GPU and the host and are initialised on the host and automatically uploaded - the default.</li>
<li><a class="el" href="d6/d8f/variableMode_8h.html#a21a79f2184074500f38877a503a4716da148e2b322b52579603075a629c3944a4">VarMode::LOC_HOST_DEVICE_INIT_DEVICE</a> - Variables are allocated on both the GPU and the host and are initialised on the GPU - best default for new models.</li>
<li><a class="el" href="d6/d8f/variableMode_8h.html#a21a79f2184074500f38877a503a4716da04da6df8bdc21d2a00fbcf479d01a83b">VarMode::LOC_ZERO_COPY_INIT_HOST</a> - Variables are allocated as 'zero-copy' memory accessible to the host and GPU and initialised on the host.</li>
<li><a class="el" href="d6/d8f/variableMode_8h.html#a21a79f2184074500f38877a503a4716da4c0c6c215310241792aef6b6e274fe03">VarMode::LOC_ZERO_COPY_INIT_DEVICE</a> - Variables are allocated as 'zero-copy' memory accessible to the host and GPU and initialised on the GPU.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>'Zero copy' memory is only supported on newer embedded systems such as the Jetson TX1 where there is no physical seperation between GPU and host memory and thus the same block of memory can be shared between them.</dd></dl>
<p>These modes can be set as a global default using <code><a class="el" href="d8/d27/namespaceGENN__PREFERENCES.html#a1f2baab3bda8720e90ef46685f2a6559" title="What is the default behaviour for model state variables? Historically, everything was allocated on bo...">GENN_PREFERENCES::defaultVarMode</a></code> or on a per-variable basis using one of the following functions:</p><ul>
<li><a class="el" href="d7/d3b/classNeuronGroup.html#a706ed67c8f75a4ebf6862e4f306ae62e" title="Set variable mode used for variables containing this neuron group&#39;s output spikes. ">NeuronGroup::setSpikeVarMode</a></li>
<li><a class="el" href="d7/d3b/classNeuronGroup.html#a50fd1cf4939e60154b1fbea2bd22058b" title="Set variable mode used for variables containing this neuron group&#39;s output spike events. ">NeuronGroup::setSpikeEventVarMode</a></li>
<li><a class="el" href="d7/d3b/classNeuronGroup.html#ae952eb833bd3cde53647536d0684d043" title="Set variable mode used for variables containing this neuron group&#39;s output spike times. ">NeuronGroup::setSpikeTimeVarMode</a></li>
<li><a class="el" href="d7/d3b/classNeuronGroup.html#a5e83c23e900e694bec9f9ac505eeeaa9" title="Set variable mode of neuron model state variable. ">NeuronGroup::setVarMode</a></li>
<li><a class="el" href="dc/dfa/classSynapseGroup.html#a089bb49a5d2b694f3e00a437b4f55407" title="Set variable mode of weight update model state variable. ">SynapseGroup::setWUVarMode</a></li>
<li><a class="el" href="dc/dfa/classSynapseGroup.html#a5db0d96c5244b6e3eb10181a94ff04b3" title="Set variable mode of postsynaptic model state variable. ">SynapseGroup::setPSVarMode</a></li>
<li><a class="el" href="dc/dfa/classSynapseGroup.html#a56bed62cefac16ddc39bb70090599742" title="Set variable mode used for variables used to combine input from this synapse group. ">SynapseGroup::setInSynVarMode</a> <hr/>
 <a class="el" href="sect_postsyn.html#sect_new_postsynaptic">Previous</a> | <a class="el" href="UserManual.html">Top</a> | <a class="el" href="Tutorial1.html">Next</a> </li>
</ul>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="UserManual.html">User Manual</a></li>
    <li class="footer">Generated on Thu Apr 19 2018 16:29:02 for GeNN by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
