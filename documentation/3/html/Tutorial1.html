<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>GeNN: Tutorial 1</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<!--This is Google Analytics Tracking Code-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-57354659-1', 'auto');
  ga('send', 'pageview');
</script>
<!--End of Google Analytics Tracking Code-->
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="customdoxygen.css" rel="stylesheet" type="text/css" />
<link href="html_styles.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em; padding-bottom: 0.5em;" id="projectlogo"><img alt="Logo" src="GeNN-logo-55px.gif"/></td>
  <td style="padding-left: 3.5em; padding-bottom: 0.5em;">
   <div id="projectname">GeNN
   &#160;<span id="projectnumber">3.1.1</span>
   </div>
   <div id="projectbrief">GPU enhanced Neuronal Networks (GeNN)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('Tutorial1.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Tutorial 1 </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>In this tutorial we will go through step by step instructions how to create and run your first GeNN simulation from scratch.</p>
<h1><a class="anchor" id="ModelDefinition"></a>
The Model Definition</h1>
<p>In this tutorial we will use a pre-defined Hodgkin-Huxley neuron model (<a class="el" href="d2/dc3/classNeuronModels_1_1TraubMiles.html" title="Hodgkin-Huxley neurons with Traub &amp; Miles algorithm. ">NeuronModels::TraubMiles</a>) and create a simulation consisting of ten such neurons without any synaptic connections. We will run this simulation on a GPU and save the results - firstly to stdout and then to file.</p>
<p>The first step is to write a model definition function in a model definition file. Create a new directory and, within that, create a new empty file called <code>tenHHModel.cc</code> using your favourite text editor, e.g. </p><div class="fragment"><div class="line">&gt;&gt; emacs tenHHModel.cc &amp;</div></div><!-- fragment --> <dl class="section note"><dt>Note</dt><dd>The "&gt;&gt;" in the example code snippets refers to a shell prompt in a unix shell, do not enter them as part of your shell commands.</dd></dl>
<p>The model definition file contains the definition of the network model we want to simulate. First, we need to include the GeNN model specification code <code><a class="el" href="dc/de1/modelSpec_8h.html" title="Header file that contains the class (struct) definition of neuronModel for defining a neuron model an...">modelSpec.h</a></code>. Then the model definition takes the form of a function named <code>modelDefinition</code> that takes one argument, passed by reference, of type <code><a class="el" href="dc/de5/classNNmodel.html">NNmodel</a></code>. Type in your <code>tenHHModel.cc</code> file: </p><div class="fragment"><div class="line"><span class="comment">// Model definintion file tenHHModel.cc</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="dc/de1/modelSpec_8h.html">modelSpec.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="keywordtype">void</span> modelDefinition(<a class="code" href="dc/de5/classNNmodel.html">NNmodel</a> &amp;model)</div><div class="line">{</div><div class="line">    <span class="comment">// definition of tenHHModel</span></div><div class="line">}</div></div><!-- fragment --><p> First we should set some options: </p><div class="fragment"><div class="line"><a class="code" href="d8/d27/namespaceGENN__PREFERENCES.html#a1f2baab3bda8720e90ef46685f2a6559">GENN_PREFERENCES::defaultVarMode</a> = <a class="code" href="d6/d8f/variableMode_8h.html#a21a79f2184074500f38877a503a4716da148e2b322b52579603075a629c3944a4">VarMode::LOC_HOST_DEVICE_INIT_DEVICE</a>;</div></div><!-- fragment --><p> The <code>defaultVarMode</code> option controls how model state variables will be initialised. The <code><a class="el" href="d6/d8f/variableMode_8h.html#a21a79f2184074500f38877a503a4716da148e2b322b52579603075a629c3944a4">VarMode::LOC_HOST_DEVICE_INIT_DEVICE</a></code> setting means that initialisation will be done on the GPU, but memory will be allocated on both the host and GPU so the values can be copied back into host memory so they can be recorded. This setting should generally be the default for new models, but section <a class="el" href="sectVariableInitialisation.html#sect_var_init_modes">Variable initialisation modes</a> outlines the full range of options as well as how you can control this option on a per-variable level. Now we need to fill the actual model definition. Three standard elements to the `modelDefinition function are initialising GeNN, setting the simulation step size and setting the name of the model: </p><div class="fragment"><div class="line"><a class="code" href="dc/de1/modelSpec_8h.html#a62ce532f6f7e535adfb9fe151a1c0c6b">initGeNN</a>();</div><div class="line">model.<a class="code" href="dc/de5/classNNmodel.html#aa8283ad87bc9d6caa854d21ca4f9b249">setDT</a>(0.1);</div><div class="line">model.<a class="code" href="dc/de5/classNNmodel.html#aba858ed73e029de0366ab23f973b1273">setName</a>(<span class="stringliteral">&quot;tenHHModel&quot;</span>);</div></div><!-- fragment --> <dl class="section note"><dt>Note</dt><dd>With this we have fixed the integration time step to <code>0.1</code> in the usual time units. The typical units in GeNN are <code>ms</code>, <code>mV</code>, <code>nF</code>, and <code>&mu;S</code>. Therefore, this defines <code>DT= 0.1 ms</code>.</dd></dl>
<p>Making the actual model definition makes use of the <a class="el" href="dc/de5/classNNmodel.html#ace4f728c03858ad86dd4d05c7f9a0b9b" title="Method for adding a neuron population to a neuronal network model, using C++ string for the name of t...">NNmodel::addNeuronPopulation</a> and <a class="el" href="dc/de5/classNNmodel.html#aae817535d08ab6b35ef1e2348b03a37c" title="This function has been depreciated as of GeNN 2.2. ">NNmodel::addSynapsePopulation</a> member functions of the <a class="el" href="dc/de5/classNNmodel.html">NNmodel</a> object. The arguments to a call to <a class="el" href="dc/de5/classNNmodel.html#ace4f728c03858ad86dd4d05c7f9a0b9b" title="Method for adding a neuron population to a neuronal network model, using C++ string for the name of t...">NNmodel::addNeuronPopulation</a> are </p><ul>
<li><code>NeuronModel</code>: template parameter specifying the neuron model class to use </li>
<li><code>const std::string &amp;name</code>: the name of the population </li>
<li><code>unsigned int size</code>: The number of neurons in the population </li>
<li><code>const NeuronModel::ParamValues &amp;paramValues</code>: Parameter values for the neurons in the population </li>
<li><code>const NeuronModel::VarValues &amp;varInitialisers</code>: Initial values or initialisation snippets for variables of this neuron type</li>
</ul>
<p>We first create the parameter and initial variable arrays, </p><div class="fragment"><div class="line"><span class="comment">// definition of tenHHModel</span></div><div class="line"><a class="code" href="da/d76/classSnippet_1_1ValueBase.html">NeuronModels::TraubMiles::ParamValues</a> p(</div><div class="line">    7.15,          <span class="comment">// 0 - gNa: Na conductance in muS</span></div><div class="line">    50.0,          <span class="comment">// 1 - ENa: Na equi potential in mV</span></div><div class="line">    1.43,          <span class="comment">// 2 - gK: K conductance in muS</span></div><div class="line">    -95.0,          <span class="comment">// 3 - EK: K equi potential in mV </span></div><div class="line">    0.02672,       <span class="comment">// 4 - gl: leak conductance in muS</span></div><div class="line">    -63.563,       <span class="comment">// 5 - El: leak equi potential in mV</span></div><div class="line">    0.143          <span class="comment">// 6 - Cmem: membr. capacity density in nF</span></div><div class="line">); </div><div class="line"></div><div class="line"><a class="code" href="d6/d53/classNewModels_1_1VarInitContainerBase.html">NeuronModels::TraubMiles::VarValues</a> ini(</div><div class="line">    -60.0,         <span class="comment">// 0 - membrane potential V</span></div><div class="line">    0.0529324,     <span class="comment">// 1 - prob. for Na channel activation m</span></div><div class="line">    0.3176767,     <span class="comment">// 2 - prob. for not Na channel blocking h</span></div><div class="line">    0.5961207      <span class="comment">// 3 - prob. for K channel activation n</span></div><div class="line">);</div></div><!-- fragment --> <dl class="section note"><dt>Note</dt><dd>The comments are obviously only for clarity, they can in principle be omitted. To avoid any confusion about the meaning of parameters and variables, however, we recommend strongly to always include comments of this type.</dd></dl>
<p>Having defined the parameter values and initial values we can now create the neuron population, </p><div class="fragment"><div class="line">model.<a class="code" href="dc/de5/classNNmodel.html#ace4f728c03858ad86dd4d05c7f9a0b9b">addNeuronPopulation</a>&lt;<a class="code" href="d2/dc3/classNeuronModels_1_1TraubMiles.html">NeuronModels::TraubMiles</a>&gt;(<span class="stringliteral">&quot;Pop1&quot;</span>, 10, p, ini);</div></div><!-- fragment --><p>The model definition then needs to end on calling </p><div class="fragment"><div class="line">model.<a class="code" href="dc/de5/classNNmodel.html#aaee7f16c9627dddb2588bad24afe5d15">finalize</a>();</div></div><!-- fragment --><p>This completes the model definition in this example. The complete <code>tenHHModel.cc</code> file now should look like this: </p><div class="fragment"><div class="line"><span class="comment">// Model definintion file tenHHModel.cc</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="dc/de1/modelSpec_8h.html">modelSpec.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="keywordtype">void</span> modelDefinition(<a class="code" href="dc/de5/classNNmodel.html">NNmodel</a> &amp;model)</div><div class="line">{</div><div class="line">    <span class="comment">// Settings</span></div><div class="line">    <a class="code" href="d8/d27/namespaceGENN__PREFERENCES.html#a1f2baab3bda8720e90ef46685f2a6559">GENN_PREFERENCES::defaultVarMode</a> = <a class="code" href="d6/d8f/variableMode_8h.html#a21a79f2184074500f38877a503a4716da148e2b322b52579603075a629c3944a4">VarMode::LOC_HOST_DEVICE_INIT_DEVICE</a>;</div><div class="line"></div><div class="line">    <span class="comment">// definition of tenHHModel</span></div><div class="line">    <a class="code" href="dc/de1/modelSpec_8h.html#a62ce532f6f7e535adfb9fe151a1c0c6b">initGeNN</a>();</div><div class="line">    model.<a class="code" href="dc/de5/classNNmodel.html#aa8283ad87bc9d6caa854d21ca4f9b249">setDT</a>(0.1);</div><div class="line">    model.<a class="code" href="dc/de5/classNNmodel.html#aba858ed73e029de0366ab23f973b1273">setName</a>(<span class="stringliteral">&quot;tenHHModel&quot;</span>);</div><div class="line"></div><div class="line">    <a class="code" href="da/d76/classSnippet_1_1ValueBase.html">NeuronModels::TraubMiles::ParamValues</a> p(</div><div class="line">        7.15,          <span class="comment">// 0 - gNa: Na conductance in muS</span></div><div class="line">        50.0,          <span class="comment">// 1 - ENa: Na equi potential in mV</span></div><div class="line">        1.43,          <span class="comment">// 2 - gK: K conductance in muS</span></div><div class="line">        -95.0,          <span class="comment">// 3 - EK: K equi potential in mV </span></div><div class="line">        0.02672,       <span class="comment">// 4 - gl: leak conductance in muS</span></div><div class="line">        -63.563,       <span class="comment">// 5 - El: leak equi potential in mV</span></div><div class="line">        0.143          <span class="comment">// 6 - Cmem: membr. capacity density in nF</span></div><div class="line">    ); </div><div class="line"></div><div class="line">    <a class="code" href="d6/d53/classNewModels_1_1VarInitContainerBase.html">NeuronModels::TraubMiles::VarValues</a> ini(</div><div class="line">        -60.0,         <span class="comment">// 0 - membrane potential V</span></div><div class="line">        0.0529324,     <span class="comment">// 1 - prob. for Na channel activation m</span></div><div class="line">        0.3176767,     <span class="comment">// 2 - prob. for not Na channel blocking h</span></div><div class="line">        0.5961207      <span class="comment">// 3 - prob. for K channel activation n</span></div><div class="line">    );</div><div class="line">    model.<a class="code" href="dc/de5/classNNmodel.html#ace4f728c03858ad86dd4d05c7f9a0b9b">addNeuronPopulation</a>&lt;<a class="code" href="d2/dc3/classNeuronModels_1_1TraubMiles.html">NeuronModels::TraubMiles</a>&gt;(<span class="stringliteral">&quot;Pop1&quot;</span>, 10, p, ini);</div><div class="line">    model.<a class="code" href="dc/de5/classNNmodel.html#aaee7f16c9627dddb2588bad24afe5d15">finalize</a>();</div><div class="line">}</div></div><!-- fragment --><p> This model definition suffices to generate code for simulating the ten Hodgkin-Huxley neurons on the a GPU or CPU. The second part of a GeNN simulation is the user code that sets up the simulation, does the data handling for input and output and generally defines the numerical experiment to be run.</p>
<h1><a class="anchor" id="buildModel"></a>
Building the model</h1>
<p>To use GeNN to build your model description into simulation code, use a terminal to navigate to the directory containing your <code>tenHHModel.cc</code> file and, on Linux or Mac, type: </p><div class="fragment"><div class="line">&gt;&gt; genn-buildmodel.sh tenHHModel.cc</div></div><!-- fragment --><p> Alternatively, on Windows, type: </p><div class="fragment"><div class="line">&gt;&gt; genn-buildmodel.bat tenHHModel.cc</div></div><!-- fragment --><p> If you don't have an NVIDIA GPU and are running GeNN in CPU_ONLY mode, you can invoke <code>genn-buildmodel</code> with a <code>-c</code> option so, on Linux or Mac: </p><div class="fragment"><div class="line">&gt;&gt; genn-buildmodel.sh -c tenHHModel.cc</div></div><!-- fragment --><p> or on Windows: </p><div class="fragment"><div class="line">&gt;&gt; genn-buildmodel.bat -c tenHHModel.cc</div></div><!-- fragment --><p> If your environment variables <code>GENN_PATH</code> and <code>CUDA_PATH</code> are correctly configured, you should see some compile output ending in <code>Model build complete ...</code>.</p>
<h1><a class="anchor" id="userCode"></a>
User Code</h1>
<p>GeNN will now have generated the code to simulate the model for one timestep using a function <code>stepTimeCPU()</code> (execution on CPU only) or <code>stepTimeGPU()</code> (execution on a GPU). To make use of this code, we need to define a minimal C/C++ main function. For the purposes of this tutorial we will initially simply run the model for one simulated second and record the final neuron variables into a file. Open a new empty file <code>tenHHSimulation.cc</code> in an editor and type </p><div class="fragment"><div class="line"><span class="comment">// tenHHModel simulation code</span></div><div class="line"><span class="preprocessor">#include &quot;tenHHModel_CODE/definitions.h&quot;</span></div><div class="line"></div><div class="line"><span class="keywordtype">int</span> <a class="code" href="df/d10/generateALL_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>()</div><div class="line">{</div><div class="line">    allocateMem();</div><div class="line">    initialize();</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --><p> This boiler plate code includes the header file for the generated code <code>definitions.h</code> in the subdirectory <code>tenHHModel_CODE</code> where GeNN deposits all generated code (this corresponds to the name passed to the <code><a class="el" href="dc/de5/classNNmodel.html#aba858ed73e029de0366ab23f973b1273" title="Method to set the neuronal network model name. ">NNmodel::setName</a></code> function). Calling <code>allocateMem()</code> allocates the memory structures for all neuron variables and <code>initialize()</code> launches a GPU kernel which initialise all state variables to their initial values. Now we can use the generated code to integrate the neuron equations provided by GeNN for 1000ms ( <img class="formulaInl" alt="$ \frac{1000}{DT}$" src="form_27.png"/> timesteps) using the GPU unless we are running CPU_ONLY mode. To do so, we add after <code>initialize();</code> </p><div class="fragment"><div class="line"><span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; (int)(1000.0 / DT); i++) {</div><div class="line"><span class="preprocessor">#ifdef CPU_ONLY</span></div><div class="line">    stepTimeCPU();</div><div class="line"><span class="preprocessor">#else</span></div><div class="line">    stepTimeGPU();</div><div class="line"><span class="preprocessor">#endif</span></div><div class="line"><span class="preprocessor">}</span></div></div><!-- fragment --><p> and, if we are running the model on the GPU, we need to copy the result back to the host before outputting it to stdout, </p><div class="fragment"><div class="line"><span class="preprocessor">#ifndef CPU_ONLY</span></div><div class="line">pullPop1StateFromDevice();</div><div class="line"><span class="preprocessor">#endif</span></div><div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">int</span> j= 0; j &lt; 10; j++) {  </div><div class="line">    cout &lt;&lt; VPop1[j] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div><div class="line">    cout &lt;&lt; mPop1[j] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div><div class="line">    cout &lt;&lt; hPop1[j] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div><div class="line">    cout &lt;&lt; nPop1[j] &lt;&lt; endl;</div><div class="line">}</div></div><!-- fragment --><p> <code>pullPop1StateFromDevice()</code> copies all relevant state variables of the <code>Pop1</code> neuron group from the GPU to the CPU main memory. Then we can output the results to stdout by looping through all 10 neurons and outputting the state variables VPop1, mPop1, hPop1, nPop1. </p><dl class="section note"><dt>Note</dt><dd>The naming convention for variables in GeNN is the variable name defined by the neuron type, here TraubMiles defining V, m, h, and n, followed by the population name, here <code>Pop1</code>.</dd></dl>
<p>This completes the user code. The complete <code>tenHHSimulation.cc</code> file should now look like </p><div class="fragment"><div class="line"><span class="comment">// tenHHModel simulation code</span></div><div class="line"><span class="preprocessor">#include &quot;tenHHModel_CODE/definitions.h&quot;</span></div><div class="line"></div><div class="line"><span class="keywordtype">int</span> <a class="code" href="df/d10/generateALL_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>()</div><div class="line">{</div><div class="line">    allocateMem();</div><div class="line">    initialize();</div><div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; (int)(1000.0 / DT); i++) {</div><div class="line"><span class="preprocessor">#ifdef CPU_ONLY</span></div><div class="line">        stepTimeCPU();</div><div class="line"><span class="preprocessor">#else</span></div><div class="line">        stepTimeGPU();</div><div class="line"><span class="preprocessor">#endif</span></div><div class="line">    }</div><div class="line"><span class="preprocessor">#ifndef CPU_ONLY</span></div><div class="line">    pullPop1StateFromDevice();</div><div class="line"><span class="preprocessor">#endif</span></div><div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j= 0; j &lt; 10; j++) {  </div><div class="line">        cout &lt;&lt; VPop1[j] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div><div class="line">        cout &lt;&lt; mPop1[j] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div><div class="line">        cout &lt;&lt; hPop1[j] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div><div class="line">        cout &lt;&lt; nPop1[j] &lt;&lt; endl;</div><div class="line">    }  </div><div class="line">    <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --><h1><a class="anchor" id="BuildingSimUnix"></a>
Building the simulator (Linux or Mac)</h1>
<p>On Linux and Mac, GeNN simulations are typically built using a simple Makefile. By convention we typically call this <code>GNUmakefile</code>. Create this file and enter </p><div class="fragment"><div class="line">EXECUTABLE      :=tenHHSimulation</div><div class="line">SOURCES         :=tenHHSimulation.cc</div><div class="line"></div><div class="line">include $(GENN_PATH)/userproject/include/makefile_common_gnu.mk</div></div><!-- fragment --><p> This defines that the final executable of this simulation is named tenHHSimulation and the simulation code is given in the file <code>tenHHSimulation.cc</code> that we completed above. Now type </p><div class="fragment"><div class="line">make</div></div><!-- fragment --><p> or, if you don't have an NVIDIA GPU and are running GeNN in CPU_ONLY mode, type: </p><div class="fragment"><div class="line">make CPU_ONLY=1</div></div><!-- fragment --><h1><a class="anchor" id="BuildingSimWindows"></a>
Building the simulator (Windows)</h1>
<p>So that projects can be easily debugged within the Visual Studio IDE (see section <a class="el" href="UserGuide.html#Debugging">Debugging suggestions</a> for more details), Windows projects are built using an MSBuild script typically with the same title as the final executable. Therefore create <code>tenHHSimulation.vcxproj</code> and type: </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;utf-8&quot;</span>?&gt;</div><div class="line">&lt;Project DefaultTargets=<span class="stringliteral">&quot;Build&quot;</span> xmlns=<span class="stringliteral">&quot;http://schemas.microsoft.com/developer/msbuild/2003&quot;</span>&gt;</div><div class="line">  &lt;Import Project=<span class="stringliteral">&quot;tenHHModel_CODE\generated_code.props&quot;</span> /&gt;</div><div class="line">  &lt;ItemGroup&gt;</div><div class="line">    &lt;ClCompile Include=<span class="stringliteral">&quot;tenHHSimulation.cc&quot;</span> /&gt;</div><div class="line">  &lt;/ItemGroup&gt;</div><div class="line">&lt;/Project&gt;</div></div><!-- fragment --><p> Now type </p><div class="fragment"><div class="line">msbuild tenHHSimulation.vcxproj /p:Configuration=Release</div></div><!-- fragment --><p> or, if you don't have an NVIDIA GPU and are running GeNN in CPU_ONLY mode, type: </p><div class="fragment"><div class="line">msbuild tenHHSimulation.vcxproj /p:Configuration=Release_CPU_ONLY</div></div><!-- fragment --><h1><a class="anchor" id="RunningSim"></a>
Running the Simulation</h1>
<p>You can now execute your newly-built simulator on Linux or Mac with </p><div class="fragment"><div class="line">./tenHHSimulation</div></div><!-- fragment --><p> Or on Windows with </p><div class="fragment"><div class="line">tenHHSimulation</div></div><!-- fragment --><p> The output you obtain should look like </p><div class="fragment"><div class="line">-63.7838 0.0350042 0.336314 0.563243</div><div class="line">-63.7838 0.0350042 0.336314 0.563243</div><div class="line">-63.7838 0.0350042 0.336314 0.563243</div><div class="line">-63.7838 0.0350042 0.336314 0.563243</div><div class="line">-63.7838 0.0350042 0.336314 0.563243</div><div class="line">-63.7838 0.0350042 0.336314 0.563243</div><div class="line">-63.7838 0.0350042 0.336314 0.563243</div><div class="line">-63.7838 0.0350042 0.336314 0.563243</div><div class="line">-63.7838 0.0350042 0.336314 0.563243</div><div class="line">-63.7838 0.0350042 0.336314 0.563243</div></div><!-- fragment --><h1><a class="anchor" id="Input"></a>
Reading</h1>
<p>This is not particularly interesting as we are just observing the final value of the membrane potentials. To see what is going on in the meantime, we need to copy intermediate values from the device and save them into a file. This can be done in many ways but one sensible way of doing this is to replace the calls to <code>stepTimeGPU</code> in <code>tenHHSimulation.cc</code> with something like this: </p><div class="fragment"><div class="line">ofstream os(<span class="stringliteral">&quot;tenHH_output.V.dat&quot;</span>);</div><div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">int</span> i= 0; i &lt; 10000; i++) {</div><div class="line"><span class="preprocessor">#ifdef CPU_ONLY</span></div><div class="line">    stepTimeCPU();</div><div class="line"><span class="preprocessor">#else</span></div><div class="line">    stepTimeGPU();</div><div class="line"><span class="preprocessor">#endif</span></div><div class="line"></div><div class="line"><span class="preprocessor">#ifndef CPU_ONLY</span></div><div class="line">    pullPop1StateFromDevice();</div><div class="line"><span class="preprocessor">#endif</span></div><div class="line">    os &lt;&lt; t &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div><div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j= 0; j &lt; 10; j++) {</div><div class="line">        os &lt;&lt; VPop1[j] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div><div class="line">    }</div><div class="line">    os &lt;&lt; endl;</div><div class="line">}</div><div class="line">os.close();</div></div><!-- fragment --> <dl class="section note"><dt>Note</dt><dd>t is a global variable updated by the GeNN code to keep track of elapsed simulation time in ms.</dd></dl>
<p>You will also need to add: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;fstream&gt;</span></div></div><!-- fragment --><p> to the top of tenHHSimulation.cc. After building the model; and building and running the simulator as described above there should be a file <code>tenHH_output.V.dat</code> in the same directory. If you plot column one (time) against the subsequent 10 columns (voltage of the 10 neurons), you should observe dynamics like this: </p><div class="image">
<img src="tenHHexample.png" alt="tenHHexample.png"/>
</div>
 <p>However so far, the neurons are not connected and do not receive input. As the <a class="el" href="d2/dc3/classNeuronModels_1_1TraubMiles.html" title="Hodgkin-Huxley neurons with Traub &amp; Miles algorithm. ">NeuronModels::TraubMiles</a> model is silent in such conditions, the membrane voltages of the 10 neurons will simply drift from the -60mV they were initialised at to their resting potential.</p>
<p><a class="el" href="sectSynapseModels.html">Previous</a> | <a class="el" href="Tutorial1.html">Top</a> | <a class="el" href="Tutorial2.html">Next</a> </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Thu Apr 19 2018 16:29:02 for GeNN by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
